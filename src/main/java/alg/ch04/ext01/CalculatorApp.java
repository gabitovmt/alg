package alg.ch04.ext01;

import alg.ch04.ext01.calc.Calculator;

public class CalculatorApp {
    private static final Calculator CALC = new Calculator();

    public static void main(String[] args) {
        // Уровень 1: Простые операции (одна операция)
        test("2 + 3", 5);
        test("5 + 1", 6);
        test("10 - 4", 6);
        test("7 - 2", 5);
        test("3 * 2", 6);
        test("4 * 5", 20);
        test("10 / 2", 5);
        test("20 / 4", 5);
        test("1 + 1", 2);
        test("50 - 10", 40);
        // Уровень 2: Две операции (без приоритета)
        test("2 + 3 + 4", 9);
        test("10 - 2 - 3", 5);
        test("2 * 3 * 2", 12);
        test("20 / 2 / 2", 5);
        test("5 + 10 - 3", 12);
        test("100 - 50 - 25", 25);
        test("3 * 4 / 2", 6);
        test("24 / 4 * 2", 12);
        test("1 + 2 + 3", 6);
        test("30 / 3 / 2", 5);
        // Уровень 3: Две операции (с приоритетом)
        test("2 + 3 * 4", 14);
        test("10 - 2 * 3", 4);
        test("5 * 2 + 3", 13);
        test("20 / 2 - 3", 7);
        test("3 + 4 * 2", 11);
        test("15 / 3 + 2", 7);
        test("2 * 5 - 4", 6);
        test("30 / 5 + 1", 7);
        test("6 + 2 * 3", 12);
        test("24 / 4 + 1", 7);
        // Уровень 4: Три операции
        test("2 + 3 * 4 - 5", 9);
        test("10 - 2 * 3 + 1", 5);
        test("5 + 2 * 3 + 4", 15);
        test("20 / 2 - 3 + 1", 8);
        test("3 * 2 + 4 / 2", 8);
        test("30 / 5 + 2 * 3", 12);
        test("100 / 10 - 3 + 2", 9);
        test("7 + 6 / 2 - 4", 6);
        test("2 * 3 + 4 * 5", 26);
        test("50 / 10 + 3 * 2", 11);
        // Уровень 5: Четыре операции (сложные выражения)
        test("2 + 3 * 4 - 5 / 1", 9);
        test("100 / 5 - 10 + 3 * 2", 16);
        test("6 * 2 + 8 / 4 - 3", 11);
        test("50 - 20 / 4 + 3 * 2", 51);
        test("7 + 8 / 2 * 3 - 1", 18);
        test("30 / 3 + 2 * 5 - 4", 16);
        test("2 * 3 + 4 * 5 - 10", 16);
        test("80 / 2 / 2 + 5 * 3", 35);
        test("9 + 6 / 3 * 2 + 1", 14);
        test("100 - 50 / 2 + 3 * 5", 90);
        // Уровень 6: Отрицательные числа
        test("-5 + 3", -2);
        test("-10 - 5", -15);
        test("-3 * 4", -12);
        test("-20 / 4", -5);
        test("5 + (-7)", -2);
        test("10 - (-5)", 15);
        test("-2 * (- 3)", 6);
        test("-20 / (- 4)", 5);
        test("-7 + 2 * 3", -1);
        test("-100 / 5 + 10", -10);
        // Уровень 7: Деление на ноль (ошибки)
        testByZero("5 / 0");
        testByZero("10 / 0");
        testByZero("0 / 0");
        testByZero("100 + 5 / 0");
        testByZero("20 - 10 / 0");
        // Уровень 8: Возведение в степень (^)
        test("2 ^ 3", 8);
        test("5 ^ 2", 25);
        test("10 ^ 2", 100);
        test("3 ^ 3", 27);
        test("2 ^ 5", 32);
        test("4 ^ 2", 16);
        test("1 ^ 100", 1);
        test("7 ^ 2", 49);
        test("2 ^ 6", 64);
        test("6 ^ 2", 36);
        // Уровень 9: Степени с приоритетом (выше *, /)
        test("2 * 3 ^ 2", 18);
        test("5 + 2 ^ 3", 13);
        test("20 / 2 ^ 2", 5);
        test("3 ^ 2 * 4", 36);
        test("100 / 5 ^ 2", 4);
        test("2 ^ 3 + 5", 13);
        test("10 - 2 ^ 2", 6);
        test("2 ^ 2 * 3 + 1", 13);
        test("32 / 2 ^ 2 + 1", 9);
        test("4 ^ 2 - 10", 6);
        // Уровень 10: Скобки (переопределение приоритета)
        test("(2 + 3) * 4", 20);
        test("(10 - 2) / 4", 2);
        test("2 * (3 + 4)", 14);
        test("(20 / 2) - 3", 7);
        test("(5 + 3) * 2", 16);
        test("((2 + 3) * 4)", 20);
        test("(10 - 5) * (3 + 2)", 25);
        test("(2 + 3) * (4 - 1)", 15);
        test("(100 / 10) + (5 * 2)", 20);
        test("((8 + 2) / 2) * 3", 15);
        // Уровень 11: Скобки со степенями
        test("(2 + 1) ^ 2", 9);
        test("2 ^ (3 + 1)", 16);
        test("(10 - 5) ^ 2", 25);
        test("(3 * 2) ^ 2", 36);
        test("2 ^ (2 + 2)", 16);
        // Уровень 12: Много операндов (5-10 операций)
        test("1 + 2 + 3 + 4 + 5", 15);
        test("10 - 1 - 2 - 3 - 1", 3);
        test("2 * 3 * 2 * 2", 24);
        test("100 / 2 / 5 / 2", 5);
        test("1 + 2 + 3 * 4 + 5", 20);
        test("50 - 10 - 5 - 3 + 2", 34);
        test("2 + 3 * 2 + 4 * 5 - 6", 22);
        test("100 / 10 + 5 + 3 + 2", 20);
        test("2 * 3 + 4 * 5 + 6 - 7", 25);
        test("90 / 3 / 3 + 2 * 5", 20);
        // Уровень 13: Много операндов со степенями и скобками
        test("2 ^ 2 + 3 ^ 2 + 4 ^ 2", 29);
        test("(1 + 2) ^ 2 + (2 + 1)", 12);
        test("2 * 3 ^ 2 - 10 + 5", 13);
        test("(5 - 2) ^ 2 + 3 * 2", 15);
        test("10 + 2 ^ 3 - 5 + 1", 14);
        test("(2 + 3) * (4 + 2) / 3", 10);
        test("100 / (5 + 5) + 3 * 2", 16);
        test("2 ^ 3 * 2 + 4 / 2", 18);
        test("(10 - 5) * 2 + 3 ^ 2", 19);
        test("5 + (3 * 2) ^ 2 - 10", 31);
        // Уровень 14: Комплексные выражения (максимальная сложность)
        test("((2 + 3) * 4 - 5) / 3", 5);
        test("2 ^ (2 + 2) + 10 / 5 - 3", 15);
        test("(100 / 10 - 5) * 3 ^ 2", 45);
        test("5 * (2 + 3 ^ 2) - 10 / 2", 50);
        test("(10 - 2) / 2 + 5 * 2 ^ 2", 24);
        test("-5 + (3 * 2) ^ 2 / 9", -1);
        test("2 ^ 3 + (4 + 2) * 3 - 10", 16);
        test("((5 + 5) ^ 2 / 20) + 3 * 2", 11);
        test("100 / (2 + 3) - 5 + 2 ^ 2", 19);
        test("(3 + 2) * (4 - 1) + (2 ^ 2 + 1)", 20);
        // Уровень 15: Граничные случаи
        test("0 + 5", 5);
        test("0 * 100", 0);
        test("0 - 10", -10);
        test("1 * 1 * 1", 1);
        test("0 / 5", 0);
        test("-0", 0);
        test("5 + 0 - 0", 5);
        test("1 ^ 0", 1);
        test("0 ^ 5", 0);
        // Уровень 16: Отрицательные числа + сложность
        test("(-5) ^ 2", 25);
        test("-2 + (-3)", -5);
        test("(-5) * (-4)", 20);
        test("-10 / (-2)", 5);
        test("(-3) ^ 2", 9);
        test("(-2) ^ 3", -8);
        test("(-1) ^ 2 + (-1) ^ 3", 0);
        test("5 + (-2) * 3", -1);
        test("(-10 + 5) * 2", -10);
        test("(-2) ^ 2 * 3 + 1", 13);
        test("((-5 + 3) ^ 2) - 2", 2);
    }

    private static void test(String expression, int expected) {
        var result = CALC.calc(expression);
        if (result != expected) {
            throw new AssertionError(String.format(
                    "Error calculating '%s': actual=%d, expected=%d", expression, result, expected
            ));
        }
    }

    private static void testByZero(String expression) {
        try {
            var result = CALC.calc(expression);
            throw new AssertionError(String.format(
                    "Error calculating '%s': actual=%d, expected ArithmeticException", expression, result
            ));
        } catch (ArithmeticException e) {
            // Nothing. It's OK
        }
    }
}
